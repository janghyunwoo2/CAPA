# 광고 도메인 지식 및 로그 데이터 스키마 (배달앱 시나리오)

## 1. 개요
본 문서는 "배달앱 서비스"를 가정하여, 광고 시스템에서 발생하는 핵심 로그(노출, 클릭, 전환)의 흐름과 각 로그에 포함되어야 할 필수 데이터를 정의합니다. 이를 통해 로그 생성기가 만들어낼 데이터의 구조를 파악하고 도메인 지식을 함양하는 것을 목표로 합니다.

## 2. 사용자 시나리오 (User Journey)
1.  **진입 (Entry)**: 사용자가 배달앱을 켭니다.
2.  **노출 (Impression)**: 앱 메인 화면 상단 배너 혹은 검색 결과 리스트 최상단에 "치킨 가게 A"의 광고가 **보여집니다**.
3.  **클릭 (Click)**: 사용자가 해당 광고 배너를 **터치(클릭)**하여 가게 상세 페이지로 이동합니다.
4.  **전환 (Conversion)**:
    *   상세 메뉴를 둘러봅니다 (View Menu).
    *   메뉴를 장바구니에 담습니다 (Add to Cart).
    *   **최종적으로 주문을 완료합니다 (Order Complete).**

---

## 3. 로그 데이터 정의

각 단계별로 생성되어야 할 데이터 필드와 그 이유(Why)를 정의합니다.

### 3.1. 광고 노출 로그 (Ad Impression Log)
사용자에게 광고가 성공적으로 렌더링되었을 때 발생하는 이벤트입니다.

| 필드명 (Field Name) | 데이터 타입 | 설명 (Description) & Why (초등학생도 알기 쉽게!) |
| :--- | :--- | :--- |
| `event_id` | UUID | **주민등록번호**. 이 세상에 딱 하나뿐인 이 사건(로그)만의 이름표예요. |
| `timestamp` | DateTime | **시계**. 언제 광고가 쨘! 하고 나타났는지 시간을 기록해요. |
| `user_id` | UUID/String | **누구**. 누가 광고를 봤는지 적어둬요. (철수가 봤는지, 영희가 봤는지 알아요) |
| `ad_id` | UUID | **포스터 번호**. 어떤 그림(치킨 A사진인지 B사진인지)을 보여줬는지 적어요. |
| `campaign_id` | UUID | **이벤트 이름**. "여름방학 할인 행사"처럼 큰 행사의 이름을 적어둬요. |
| `shop_id` | UUID | **사장님 이름**. 어느 가게의 광고인지 적어야 나중에 광고비를 누구한테 청구할지 알겠죠? |
| `placement` | String | **자리**. 광고가 맨 위에 떴는지, 중간에 떴는지 위치를 적어요. (명당 자리는 비싸니까요!) |
| `platform` | String | **도구**. 핸드폰(앱)으로 봤는지, 컴퓨터(웹)로 봤는지 적어요. |
| `bid_price` | Float | **입찰가**. 사장님이 "이 자리에 내 광고 내보내주세요!"라고 얼마를 불렀는지 적은 비밀 장부예요. |

### 3.2. 광고 클릭 로그 (Ad Click Log)
사용자가 광고를 클릭했을 때 발생하는 이벤트입니다. **가장 중요한 것은 어떤 노출(Impression)에서 이 클릭이 발생했는지 연결하는 것입니다.**

| 필드명 (Field Name) | 데이터 타입 | 설명 (Description) & Why (초등학생도 알기 쉽게!) |
| :--- | :--- | :--- |
| `event_id` | UUID | **주민등록번호**. 클릭 사건 하나하나마다 붙이는 고유한 이름표예요. |
| `timestamp` | DateTime | **시계**. 언제 손가락으로 꾹 눌렀는지 시간을 적어요. |
| `user_id` | UUID/String | **누구**. 누가 눌렀는지 적어요. |
| `ad_id` | UUID | **포스터 번호**. 어떤 광고 그림을 눌렀는지 적어요. |
| `impression_id` | UUID | **연결 고리(Key)**. **"아까 보여줬던 그 광고(노출) 때문에 누른 거야!"**라고 알려주는 끈이에요. 이게 없으면 그냥 누른 건지, 광고 보고 누른 건지 몰라요. |
| `shop_id` | UUID | **사장님 이름**. 어느 가게 광고를 눌렀는지 적어요. |
| `clickspot_x` | Integer | **터치 위치(가로)**. 광고 배너의 왼쪽/오른쪽 중 어디를 눌렀는지 적어요. |
| `clickspot_y` | Integer | **터치 위치(세로)**. 위/아래 중 어디를 눌렀는지 적어요. |
| `cpc_cost` | Float | **영수증**. **"이번 클릭 때문에 사장님 지갑에서 500원 나갔습니다"**라고 적는 진짜 비용이에요. |

### 3.3. 광고 전환 로그 (Ad Conversion Log)
광고 클릭 이후 발생한 유의미한 행동(장바구니, 주문 등)입니다. **기여(Attribution)** 분석의 핵심입니다.

| 필드명 (Field Name) | 데이터 타입 | 설명 (Description) & Why (초등학생도 알기 쉽게!) |
| :--- | :--- | :--- |
| `event_id` | UUID | **주민등록번호**. 물건을 사거나 장바구니에 담은 사건의 이름표예요. |
| `timestamp` | DateTime | **시계**. 언제 샀는지 시간을 적어요. |
| `user_id` | UUID/String | **누구**. 누가 샀는지 적어요. |
| `shop_id` | UUID | **사장님 이름**. 어느 가게에서 샀는지 적어요. |
| `click_id` | UUID | **연결 고리(Key)**. **"아까 광고 눌렀던(클릭) 덕분에 산 거야!"**라고 증명해주는 끈이에요. 이게 있어야 광고 효과를 인정받아요. |
| `ad_id` | UUID | **포스터 번호**. 어떤 광고 보고 들어왔었는지 한번 더 적어줘요. |
| `action_type` | String | **행동**. 구경만 했는지, 장바구니에 담았는지, **진짜 샀는지(주문)** 적어요. |
| `total_amount` | Float | **매출액**. 얼마치를 샀는지 적어요. (광고비보다 많이 벌었는지 계산해야 하니까요!) |
| `item_count` | Integer | **개수**. 치킨 한 마리인지, 두 마리인지 몇 개 샀는지 적어요. |

---

## 5. 핵심 용어 및 지표 (Terminology & Metrics)

사용자가 요청한 주요 도메인 용어에 대한 정의입니다.

### 5.1. 엔티티 (Entities)
*   **광고 지면 (Ad Slot / Placement)**: **전단지 붙이는 자리**. 학교 게시판인지, 식당 유리창인지 자리를 말해요.
*   **광고주 (Advertiser)**: **돈 내는 사장님**. 치킨집 사장님, 피자집 사장님이에요.
*   **캠페인 (Campaign)**: **작전명**. "여름방학 맞이 대할인 작전!" 같은 큰 계획의 이름이에요.
*   **크리에이티브 (Creative)**: **그림**. 손님에게 보여줄 예쁜 치킨 사진이나 "지금 주문하면 반값!" 같은 문구예요.

### 5.2. 성과 지표 (Key Metrics)
*   **노출 (Impression)**: **눈도장**. 손님이 우리 광고를 쓱 한번 본 거예요.
*   **클릭 (Click)**: **관심**. "어? 맛있겠네?" 하고 손가락으로 누른 거예요.
*   **전환 (Conversion)**: **골인**. 구경만 한 게 아니라 진짜로 물건을 사거나 장바구니에 담은 성공적인 행동이에요.
*   **CPC (Cost Per Click)**: **클릭비**. 손님이 광고를 한번 누를 때마다 사장님이 내야 하는 돈이에요. (누르면 돈 나가요!)
*   **CTR (Click-Through Rate, 클릭률)**: **인기 투표율**. 100명한테 보여줬을 때 몇 명이 눌렀냐는 거예요. (높을수록 "와 이 사진 대박이네!"라는 뜻)
*   **CVR (Conversion Rate, 전환율)**: **구매 성공률**. 들어온 손님 100명 중에 진짜 산 사람이 몇 명이냐는 거예요. (높을수록 "이 집 맛집이네!"라는 뜻)
*   **RPM (Revenue Per Mille)**: **자리값**. 이 자리에 광고를 1,000번 보여주면 사장님이 얼마를 벌 수 있는지 나타내는 점수예요.

---

## 6. 데이터 흐름 요약 (Example)

1.  **Impression (사용자 노출 로그)**:
    *   `event_id`: **IMP_001**
    *   `user_id`: U_100
    *   `ad_id` (Creative): AD_50
    *   `shop_id` (Advertiser): SHOP_A
2.  **Click (사용자 클릭 로그)**:
    *   `event_id`: **CLK_999**
    *   `impression_id`: **IMP_001** (위의 노출과 연결됨)
    *   `user_id`: U_100
3.  **Conversion (사용자 전환 로그)**:
    *   `event_id`: CNV_888
    *   `click_id`: **CLK_999** (위의 클릭과 연결됨)
    *   `action_type`: "order"
    *   `total_amount`: 25,000 (매출 발생 -> ROAS 분석 가능)

> **📝 설명 (철수의 하루)**
>
> 1.  **Impression (눈도장)**
>     *   **상황**: 철수(`U_100`)가 앱을 켰는데, 치킨 광고(`AD_50`)가 떴습니다.
>     *   **주요 정보**: 이때 주민등록번호처럼 `IMP_001`이라는 로그 이름표가 생깁니다.
> 2.  **Click (관심)**
>     *   **상황**: 철수가 그 광고가 맛있어 보여서 눌렀습니다.
>     *   **연결 고리**: 이때 시스템은 "이 클릭(`CLK_999`)은 아까 `IMP_001` 광고를 보고 누른 거야!"라고 `impression_id: IMP_001`을 적어둡니다. (이게 없으면 그냥 심심해서 누른 건지, 광고 보고 누른 건지 모릅니다.)
> 3.  **Conversion (골인)**
>     *   **상황**: 들어와서 진짜로 25,000원어치 주문(`order`)을 했습니다.
>     *   **연결 고리**: 시스템은 "이 주문(`CNV_888`)은 아까 그 클릭(`CLK_999`) 덕분에 일어난 거야!"라고 `click_id: CLK_999`를 적어둡니다.
>
> **결론**: 따로따로 흩어져 있는 로그들을 **ID(이름표)로 연결해서 "광고 봄 -> 클릭함 -> 구매함"이라는 하나의 이야기를 만드는 과정**을 보여주는 예시입니다.

## 7. 학습 포인트
*   **Funnel (깔때기) 구조**: 노출 > 클릭 > 전환으로 이어지는 사용자의 수와 비율을 이해해야 합니다.
*   **Join Key**: 분산된 로그 환경(로그 파일이 다름)에서 `impression_id`와 `click_id`를 통해 어떻게 하나의 여정으로 묶을지 고민해야 합니다.
*   **Conversion Window**: 클릭 후 몇 시간/며칠 이내의 구매까지 광고 성과로 인정할 것인가? (보통 배달앱은 당일 혹은 1~2시간 이내)
